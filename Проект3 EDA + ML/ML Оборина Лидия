{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "EDA и первая модель ML\n",
    "Цель проекта - Сформулировать предположения для построения модели. Проверить качество данных и очистить их. Определиться с параметрами модели. Получить метрику Mean Absolute Error (MAE), которая показывает среднее отклонение предсказанных значений от фактических."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('main_task.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Информация о признаках\n",
    "Restaurant_id — идентификационный номер ресторана / сети ресторанов;\n",
    "City — город, в котором находится ресторан;\n",
    "Cuisine Style — кухня или кухни, к которым можно отнести блюда, предлагаемые в ресторане;\n",
    "Ranking — место, которое занимает данный ресторан среди всех ресторанов своего города;\n",
    "Rating — рейтинг ресторана по данным TripAdvisor (именно это значение должна будет предсказывать модель);\n",
    "Price Range — диапазон цен в ресторане;\n",
    "Number of Reviews — количество отзывов о ресторане;\n",
    "Reviews — данные о двух отзывах, которые отображаются на сайте ресторана;\n",
    "URL_TA — URL страницы ресторана на TripAdvisor;\n",
    "ID_TA — идентификатор ресторана в базе данных TripAdvisor."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Restaurant_id</th>\n",
       "      <th>City</th>\n",
       "      <th>Cuisine Style</th>\n",
       "      <th>Ranking</th>\n",
       "      <th>Rating</th>\n",
       "      <th>Price Range</th>\n",
       "      <th>Number of Reviews</th>\n",
       "      <th>Reviews</th>\n",
       "      <th>URL_TA</th>\n",
       "      <th>ID_TA</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>25343</td>\n",
       "      <td>id_2145</td>\n",
       "      <td>Rome</td>\n",
       "      <td>['Italian', 'Pizza', 'Pub', 'Gastropub']</td>\n",
       "      <td>2146.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>$$ - $$$</td>\n",
       "      <td>89.0</td>\n",
       "      <td>[[], []]</td>\n",
       "      <td>/Restaurant_Review-g187791-d9782878-Reviews-Pi...</td>\n",
       "      <td>d9782878</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>32372</td>\n",
       "      <td>id_3313</td>\n",
       "      <td>Prague</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3320.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.0</td>\n",
       "      <td>[['Sports bar', 'Hidden Gem'], ['11/11/2014', ...</td>\n",
       "      <td>/Restaurant_Review-g274707-d4597143-Reviews-Ho...</td>\n",
       "      <td>d4597143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>id_1418</td>\n",
       "      <td>Oporto</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1419.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>[['There are better 3 star hotel bars', 'Amazi...</td>\n",
       "      <td>/Restaurant_Review-g189180-d12503536-Reviews-D...</td>\n",
       "      <td>d12503536</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Restaurant_id    City                             Cuisine Style  \\\n",
       "25343       id_2145    Rome  ['Italian', 'Pizza', 'Pub', 'Gastropub']   \n",
       "32372       id_3313  Prague                                       NaN   \n",
       "5           id_1418  Oporto                                       NaN   \n",
       "\n",
       "       Ranking  Rating Price Range  Number of Reviews  \\\n",
       "25343   2146.0     4.5    $$ - $$$               89.0   \n",
       "32372   3320.0     4.0         NaN                9.0   \n",
       "5       1419.0     3.0         NaN                2.0   \n",
       "\n",
       "                                                 Reviews  \\\n",
       "25343                                           [[], []]   \n",
       "32372  [['Sports bar', 'Hidden Gem'], ['11/11/2014', ...   \n",
       "5      [['There are better 3 star hotel bars', 'Amazi...   \n",
       "\n",
       "                                                  URL_TA      ID_TA  \n",
       "25343  /Restaurant_Review-g187791-d9782878-Reviews-Pi...   d9782878  \n",
       "32372  /Restaurant_Review-g274707-d4597143-Reviews-Ho...   d4597143  \n",
       "5      /Restaurant_Review-g189180-d12503536-Reviews-D...  d12503536  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Просматриваем данные\n",
    "df.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Переименуем столбцы\n",
    "# df.rename(columns={'Restaurant_id': 'restaurant_id','City': 'city','Cuisine Style': 'cuisine_style','Ranking': 'ranking', 'Rating': 'rating','Price Range': 'price_range','Number of Reviews': 'nor','Reviews': 'reviews','URL_TA': 'url_ta','ID_TA': 'id_ta'}, inplace=True)\n",
    "df.columns=['restaurant_id','city','cuisine_style','ranking','rating','price_range','nor','reviews','url_ta','id_ta']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>city</th>\n",
       "      <th>cuisine_style</th>\n",
       "      <th>ranking</th>\n",
       "      <th>rating</th>\n",
       "      <th>price_range</th>\n",
       "      <th>nor</th>\n",
       "      <th>reviews</th>\n",
       "      <th>url_ta</th>\n",
       "      <th>id_ta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>22735</td>\n",
       "      <td>id_2892</td>\n",
       "      <td>Barcelona</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2893.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.0</td>\n",
       "      <td>[['Great, charming unpretentious gem!', 'Sophi...</td>\n",
       "      <td>/Restaurant_Review-g187497-d12998670-Reviews-P...</td>\n",
       "      <td>d12998670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>34367</td>\n",
       "      <td>id_4792</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>['Peruvian', 'South American']</td>\n",
       "      <td>4795.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>[[], []]</td>\n",
       "      <td>/Restaurant_Review-g187514-d10751196-Reviews-E...</td>\n",
       "      <td>d10751196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>27582</td>\n",
       "      <td>id_5705</td>\n",
       "      <td>London</td>\n",
       "      <td>['Lebanese', 'Mediterranean', 'Middle Eastern'...</td>\n",
       "      <td>5714.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>$$ - $$$</td>\n",
       "      <td>98.0</td>\n",
       "      <td>[['Delicious and not overpriced for location',...</td>\n",
       "      <td>/Restaurant_Review-g186338-d1386572-Reviews-By...</td>\n",
       "      <td>d1386572</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      restaurant_id       city  \\\n",
       "22735       id_2892  Barcelona   \n",
       "34367       id_4792     Madrid   \n",
       "27582       id_5705     London   \n",
       "\n",
       "                                           cuisine_style  ranking  rating  \\\n",
       "22735                                                NaN   2893.0     4.5   \n",
       "34367                     ['Peruvian', 'South American']   4795.0     4.5   \n",
       "27582  ['Lebanese', 'Mediterranean', 'Middle Eastern'...   5714.0     4.0   \n",
       "\n",
       "      price_range   nor                                            reviews  \\\n",
       "22735         NaN  10.0  [['Great, charming unpretentious gem!', 'Sophi...   \n",
       "34367         NaN   3.0                                           [[], []]   \n",
       "27582    $$ - $$$  98.0  [['Delicious and not overpriced for location',...   \n",
       "\n",
       "                                                  url_ta      id_ta  \n",
       "22735  /Restaurant_Review-g187497-d12998670-Reviews-P...  d12998670  \n",
       "34367  /Restaurant_Review-g187514-d10751196-Reviews-E...  d10751196  \n",
       "27582  /Restaurant_Review-g186338-d1386572-Reviews-By...   d1386572  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# смотрим на данные после переименования столбцов\n",
    "df.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "$$ - $$$    18412\n",
      "$            6279\n",
      "$$$$         1423\n",
      "Name: price_range, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# смотрим на количество уникальных значений по столбцу, \n",
    "# определяем сколько ресторанов относятся к среднему ценовому сегменту\n",
    "print(df['price_range'].value_counts())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "18412"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# определяем сколько ресторанов относятся к среднему ценовому сегменту\n",
    "df[df.price_range =='$$ - $$$'].restaurant_id.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "31"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# посчитаем сколько городов в наборе данных\n",
    "df['city'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "125\n"
     ]
    }
   ],
   "source": [
    "# Сколько типов кухонь представлено в наборе данных? Создаем список и заменяем пропуски\n",
    "def make_list(n_str):\n",
    "    n_str = n_str.replace('[','')\n",
    "    n_str = n_str.replace(']','')\n",
    "    n_list = n_str.split(', ')\n",
    "    return list(n_list)\n",
    "\n",
    "df['cuisine_style'] = df['cuisine_style'].fillna('none')\n",
    "df['cuisine_style'] = df['cuisine_style'].apply(make_list)\n",
    "\n",
    "cs_list = []\n",
    "\n",
    "for i in range(0, len(df['cuisine_style'])):\n",
    "    \n",
    "    one_list = df['cuisine_style'][i] \n",
    "    \n",
    "    for elem in one_list:             \n",
    "        if elem not in cs_list and elem != 'none':\n",
    "            cs_list.append(elem)\n",
    "            \n",
    "print(len(cs_list))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[(\"'Vegetarian Friendly'\", 11189)]\n"
     ]
    }
   ],
   "source": [
    "# какая кухня самая популярная?\n",
    "cs_liste = []\n",
    "\n",
    "for i in range (0, len(df['cuisine_style'])):\n",
    "    one_list = list(df['cuisine_style'][i])\n",
    "    for elem in one_list:\n",
    "        if elem != 'none':\n",
    "            cs_liste.append(elem)\n",
    "\n",
    "import collections\n",
    "c = collections.Counter()\n",
    "\n",
    "for word in cs_liste:\n",
    "    c[word] += 1\n",
    "    \n",
    "print(c.most_common(1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2.6224\n"
     ]
    }
   ],
   "source": [
    "# определяем среднее значение количества кухонь в ресторанах и создаем дополнительный признак\n",
    "def cnt_kitchen(n_list):\n",
    "    cnt = 0\n",
    "    for elem in n_list:\n",
    "        if elem != 'none':\n",
    "            cnt += 1\n",
    "        else:\n",
    "            cnt = 1\n",
    "    return cnt\n",
    "\n",
    "df['cnt_kitchen'] = df['cuisine_style'].apply(cnt_kitchen)\n",
    "\n",
    "print(df['cnt_kitchen'].mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0        3\n",
      "1        1\n",
      "2        7\n",
      "3        1\n",
      "4        3\n",
      "        ..\n",
      "39995    4\n",
      "39996    5\n",
      "39997    2\n",
      "39998    5\n",
      "39999    1\n",
      "Name: cnt_kitchen, Length: 40000, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# выодим дополнительный признак - количество кухонь в ресторане\n",
    "print(df['cnt_kitchen'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2004-04-21 00:00:00\n",
      "2018-02-26 00:00:00\n"
     ]
    }
   ],
   "source": [
    "# определяем когда был оставлен самый свежий отзыв\n",
    "import re\n",
    "date_comment = df['reviews'][0]\n",
    "\n",
    "def search_date(n_str):\n",
    "    found_date = re.findall('\\d{2}\\/\\d{2}\\/\\d{4}', n_str)\n",
    "    if len(found_date) == 0:\n",
    "        found_date = 'no_date'\n",
    "    return found_date\n",
    "\n",
    "df['reviews_date'] = df['reviews'].apply(search_date)\n",
    "\n",
    "len_rev = len(df['reviews_date'])\n",
    "\n",
    "cs_list = []\n",
    "\n",
    "for i in range (0, len_rev):\n",
    "    one_list = df['reviews_date'][i]\n",
    "    for elem in one_list:\n",
    "        if elem not in 'no_date':\n",
    "            cs_list.append(pd.to_datetime(elem, format='%m/%d/%Y'))\n",
    "\n",
    "# pd.to_datetime(df['date_time_column'], format='%m/%d/%Y')\n",
    "\n",
    "print(min(cs_list))\n",
    "print(max(cs_list))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3207 days 00:00:00\n"
     ]
    }
   ],
   "source": [
    "# какое максимальное количество дней отделяет даты публикации отзывов, размещённых на сайте ресторана?\n",
    "cs_list = []\n",
    "\n",
    "for i in range (0, len_rev):\n",
    "    one_list = df['reviews_date'][i]\n",
    "    if len(one_list) == 2:\n",
    "        f_date = pd.to_datetime(one_list[0], format='%m/%d/%Y')\n",
    "        s_date = pd.to_datetime(one_list[1], format='%m/%d/%Y')\n",
    "        cs_list.append(f_date - s_date)\n",
    "\n",
    "print(max(cs_list))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0        2\n",
      "1        0\n",
      "2        3\n",
      "3        0\n",
      "4        2\n",
      "        ..\n",
      "39995    2\n",
      "39996    2\n",
      "39997    0\n",
      "39998    2\n",
      "39999    2\n",
      "Name: price_range, Length: 40000, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# создаём дополнительный признак об уровне цен, а также заменяем пропуски\n",
    "def range_value(n_str):\n",
    "    if n_str == 0:\n",
    "        res = 0\n",
    "    elif n_str == '$':\n",
    "        res = 1\n",
    "    elif n_str == '$$ - $$$':\n",
    "        res = 2\n",
    "    else:\n",
    "        res = 3\n",
    "    return res\n",
    "\n",
    "df['price_range'] = df['price_range'].fillna(0)\n",
    "df['price_range'] = df['price_range'].apply(range_value)\n",
    "\n",
    "print(df['price_range'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>city</th>\n",
       "      <th>cuisine_style</th>\n",
       "      <th>ranking</th>\n",
       "      <th>rating</th>\n",
       "      <th>price_range</th>\n",
       "      <th>nor</th>\n",
       "      <th>reviews</th>\n",
       "      <th>url_ta</th>\n",
       "      <th>id_ta</th>\n",
       "      <th>cnt_kitchen</th>\n",
       "      <th>reviews_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>id_5569</td>\n",
       "      <td>Paris</td>\n",
       "      <td>['European', 'French', 'International']</td>\n",
       "      <td>5570.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>2</td>\n",
       "      <td>194.0</td>\n",
       "      <td>[['Good food at your doorstep', 'A good hotel ...</td>\n",
       "      <td>/Restaurant_Review-g187147-d1912643-Reviews-R_...</td>\n",
       "      <td>d1912643</td>\n",
       "      <td>3</td>\n",
       "      <td>[12/31/2017, 11/20/2017]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>id_1535</td>\n",
       "      <td>Stockholm</td>\n",
       "      <td>[none]</td>\n",
       "      <td>1537.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>[['Unique cuisine', 'Delicious Nepalese food']...</td>\n",
       "      <td>/Restaurant_Review-g189852-d7992032-Reviews-Bu...</td>\n",
       "      <td>d7992032</td>\n",
       "      <td>1</td>\n",
       "      <td>[07/06/2017, 06/19/2016]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>id_352</td>\n",
       "      <td>London</td>\n",
       "      <td>['Japanese', 'Sushi', 'Asian', 'Grill', 'Veget...</td>\n",
       "      <td>353.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3</td>\n",
       "      <td>688.0</td>\n",
       "      <td>[['Catch up with friends', 'Not exceptional'],...</td>\n",
       "      <td>/Restaurant_Review-g186338-d8632781-Reviews-RO...</td>\n",
       "      <td>d8632781</td>\n",
       "      <td>7</td>\n",
       "      <td>[01/08/2018, 01/06/2018]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>id_3456</td>\n",
       "      <td>Berlin</td>\n",
       "      <td>[none]</td>\n",
       "      <td>3458.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>[[], []]</td>\n",
       "      <td>/Restaurant_Review-g187323-d1358776-Reviews-Es...</td>\n",
       "      <td>d1358776</td>\n",
       "      <td>1</td>\n",
       "      <td>no_date</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>id_615</td>\n",
       "      <td>Munich</td>\n",
       "      <td>['German', 'Central European', 'Vegetarian Fri...</td>\n",
       "      <td>621.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2</td>\n",
       "      <td>84.0</td>\n",
       "      <td>[['Best place to try a Bavarian food', 'Nice b...</td>\n",
       "      <td>/Restaurant_Review-g187309-d6864963-Reviews-Au...</td>\n",
       "      <td>d6864963</td>\n",
       "      <td>3</td>\n",
       "      <td>[11/18/2017, 02/19/2017]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39995</td>\n",
       "      <td>id_499</td>\n",
       "      <td>Milan</td>\n",
       "      <td>['Italian', 'Vegetarian Friendly', 'Vegan Opti...</td>\n",
       "      <td>500.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2</td>\n",
       "      <td>79.0</td>\n",
       "      <td>[['The real Italian experience!', 'Wonderful f...</td>\n",
       "      <td>/Restaurant_Review-g187849-d2104414-Reviews-Ro...</td>\n",
       "      <td>d2104414</td>\n",
       "      <td>4</td>\n",
       "      <td>[12/16/2017, 11/12/2017]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39996</td>\n",
       "      <td>id_6340</td>\n",
       "      <td>Paris</td>\n",
       "      <td>['French', 'American', 'Bar', 'European', 'Veg...</td>\n",
       "      <td>6341.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>2</td>\n",
       "      <td>542.0</td>\n",
       "      <td>[['Parisian atmosphere', 'Bit pricey but inter...</td>\n",
       "      <td>/Restaurant_Review-g187147-d1800036-Reviews-La...</td>\n",
       "      <td>d1800036</td>\n",
       "      <td>5</td>\n",
       "      <td>[12/21/2017, 12/12/2017]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39997</td>\n",
       "      <td>id_1649</td>\n",
       "      <td>Stockholm</td>\n",
       "      <td>['Japanese', 'Sushi']</td>\n",
       "      <td>1652.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>[['Good by swedish standards', 'A hidden jewel...</td>\n",
       "      <td>/Restaurant_Review-g189852-d947615-Reviews-Sus...</td>\n",
       "      <td>d947615</td>\n",
       "      <td>2</td>\n",
       "      <td>[11/03/2016, 04/12/2008]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39998</td>\n",
       "      <td>id_640</td>\n",
       "      <td>Warsaw</td>\n",
       "      <td>['Polish', 'European', 'Eastern European', 'Ce...</td>\n",
       "      <td>641.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2</td>\n",
       "      <td>70.0</td>\n",
       "      <td>[['Underground restaurant', 'Oldest Restaurant...</td>\n",
       "      <td>/Restaurant_Review-g274856-d1100838-Reviews-Ho...</td>\n",
       "      <td>d1100838</td>\n",
       "      <td>5</td>\n",
       "      <td>[07/11/2017, 06/18/2017]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39999</td>\n",
       "      <td>id_4824</td>\n",
       "      <td>Milan</td>\n",
       "      <td>['Spanish']</td>\n",
       "      <td>4827.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2</td>\n",
       "      <td>260.0</td>\n",
       "      <td>[['Average', 'Nice an informal'], ['01/31/2016...</td>\n",
       "      <td>/Restaurant_Review-g187849-d1109020-Reviews-Ta...</td>\n",
       "      <td>d1109020</td>\n",
       "      <td>1</td>\n",
       "      <td>[01/31/2016, 07/04/2012]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40000 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      restaurant_id       city  \\\n",
       "0           id_5569      Paris   \n",
       "1           id_1535  Stockholm   \n",
       "2            id_352     London   \n",
       "3           id_3456     Berlin   \n",
       "4            id_615     Munich   \n",
       "...             ...        ...   \n",
       "39995        id_499      Milan   \n",
       "39996       id_6340      Paris   \n",
       "39997       id_1649  Stockholm   \n",
       "39998        id_640     Warsaw   \n",
       "39999       id_4824      Milan   \n",
       "\n",
       "                                           cuisine_style  ranking  rating  \\\n",
       "0                ['European', 'French', 'International']   5570.0     3.5   \n",
       "1                                                 [none]   1537.0     4.0   \n",
       "2      ['Japanese', 'Sushi', 'Asian', 'Grill', 'Veget...    353.0     4.5   \n",
       "3                                                 [none]   3458.0     5.0   \n",
       "4      ['German', 'Central European', 'Vegetarian Fri...    621.0     4.0   \n",
       "...                                                  ...      ...     ...   \n",
       "39995  ['Italian', 'Vegetarian Friendly', 'Vegan Opti...    500.0     4.5   \n",
       "39996  ['French', 'American', 'Bar', 'European', 'Veg...   6341.0     3.5   \n",
       "39997                              ['Japanese', 'Sushi']   1652.0     4.5   \n",
       "39998  ['Polish', 'European', 'Eastern European', 'Ce...    641.0     4.0   \n",
       "39999                                        ['Spanish']   4827.0     3.0   \n",
       "\n",
       "       price_range    nor                                            reviews  \\\n",
       "0                2  194.0  [['Good food at your doorstep', 'A good hotel ...   \n",
       "1                0   10.0  [['Unique cuisine', 'Delicious Nepalese food']...   \n",
       "2                3  688.0  [['Catch up with friends', 'Not exceptional'],...   \n",
       "3                0    3.0                                           [[], []]   \n",
       "4                2   84.0  [['Best place to try a Bavarian food', 'Nice b...   \n",
       "...            ...    ...                                                ...   \n",
       "39995            2   79.0  [['The real Italian experience!', 'Wonderful f...   \n",
       "39996            2  542.0  [['Parisian atmosphere', 'Bit pricey but inter...   \n",
       "39997            0    4.0  [['Good by swedish standards', 'A hidden jewel...   \n",
       "39998            2   70.0  [['Underground restaurant', 'Oldest Restaurant...   \n",
       "39999            2  260.0  [['Average', 'Nice an informal'], ['01/31/2016...   \n",
       "\n",
       "                                                  url_ta     id_ta  \\\n",
       "0      /Restaurant_Review-g187147-d1912643-Reviews-R_...  d1912643   \n",
       "1      /Restaurant_Review-g189852-d7992032-Reviews-Bu...  d7992032   \n",
       "2      /Restaurant_Review-g186338-d8632781-Reviews-RO...  d8632781   \n",
       "3      /Restaurant_Review-g187323-d1358776-Reviews-Es...  d1358776   \n",
       "4      /Restaurant_Review-g187309-d6864963-Reviews-Au...  d6864963   \n",
       "...                                                  ...       ...   \n",
       "39995  /Restaurant_Review-g187849-d2104414-Reviews-Ro...  d2104414   \n",
       "39996  /Restaurant_Review-g187147-d1800036-Reviews-La...  d1800036   \n",
       "39997  /Restaurant_Review-g189852-d947615-Reviews-Sus...   d947615   \n",
       "39998  /Restaurant_Review-g274856-d1100838-Reviews-Ho...  d1100838   \n",
       "39999  /Restaurant_Review-g187849-d1109020-Reviews-Ta...  d1109020   \n",
       "\n",
       "       cnt_kitchen              reviews_date  \n",
       "0                3  [12/31/2017, 11/20/2017]  \n",
       "1                1  [07/06/2017, 06/19/2016]  \n",
       "2                7  [01/08/2018, 01/06/2018]  \n",
       "3                1                   no_date  \n",
       "4                3  [11/18/2017, 02/19/2017]  \n",
       "...            ...                       ...  \n",
       "39995            4  [12/16/2017, 11/12/2017]  \n",
       "39996            5  [12/21/2017, 12/12/2017]  \n",
       "39997            2  [11/03/2016, 04/12/2008]  \n",
       "39998            5  [07/11/2017, 06/18/2017]  \n",
       "39999            1  [01/31/2016, 07/04/2012]  \n",
       "\n",
       "[40000 rows x 12 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# df = df[['price_range','rating']]\n",
    "# смотрим на преобразованный df\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "restaurant_id       0\n",
       "city                0\n",
       "cuisine_style       0\n",
       "ranking             0\n",
       "rating              0\n",
       "price_range         0\n",
       "nor              2543\n",
       "reviews             0\n",
       "url_ta              0\n",
       "id_ta               0\n",
       "cnt_kitchen         0\n",
       "reviews_date        0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# посмотрим на содержание пропусков в столбцах\n",
    "df.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "# замена пропусков в столбце nor (Number of Reviews)\n",
    "df['nor'].fillna(df['nor'].mean(),inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "# создаем дополнительный признак - население города исходя из названия города\n",
    "def fill_population(s):\n",
    "    if s == \"Paris\":\n",
    "        return 2.148\n",
    "    elif s == \"Stockholm\":\n",
    "        return 0.976\n",
    "    elif s == \"London\":\n",
    "        return 8.982\n",
    "    elif s == \"Berlin\":\n",
    "        return 3.769\n",
    "    elif s == \"Munich\":\n",
    "        return 1.472\n",
    "    elif s == \"Oporto\":\n",
    "        return 0.214\n",
    "    elif s == \"Milan\":\n",
    "        return 1.352\n",
    "    elif s == \"Bratislava\":\n",
    "        return 0.424\n",
    "    elif s == \"Vienna\":\n",
    "        return 1.897\n",
    "    elif s == \"Rome\":\n",
    "        return 2.873\n",
    "    elif s == \"Barcelona\":\n",
    "        return 5.575\n",
    "    elif s == \"Madrid\":\n",
    "        return 6.642\n",
    "    elif s == \"Dublin\":\n",
    "        return 1.388\n",
    "    elif s == \"Brussels\":\n",
    "        return 0.174\n",
    "    elif s == \"Zurich\":\n",
    "        return 0.403\n",
    "    elif s == \"Warsaw\":\n",
    "        return 1.708\n",
    "    elif s == \"Budapest\":\n",
    "        return 1.752\n",
    "    elif s == \"Copenhagen\":\n",
    "        return 0.603\n",
    "    elif s == \"Amsterdam\":\n",
    "        return 0.823\n",
    "    elif s == \"Lyon\":\n",
    "        return 0.513\n",
    "    elif s == \"Hamburg\":\n",
    "        return 1.845\n",
    "    elif s == \"Lisbon\":\n",
    "        return 0.505\n",
    "    elif s == \"Prague\":\n",
    "        return 1.309\n",
    "    elif s == \"Oslo\":\n",
    "        return 0.681\n",
    "    elif s == \"Helsinki\":\n",
    "        return 0.632\n",
    "    elif s == \"Edinburgh\":\n",
    "        return 0.482\n",
    "    elif s == \"Geneva\":\n",
    "        return 0.5\n",
    "    elif s == \"Ljubljana\":\n",
    "        return 0.28\n",
    "    elif s == \"Athens\":\n",
    "        return 0.664\n",
    "    elif s == \"Luxembourg\":\n",
    "        return 0.614\n",
    "    elif s == \"Krakow\":\n",
    "        return 0.763"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# добавляем новый признак с числовыми значениями в датафрейм\n",
    "df['city_population'] = df['city'].apply(fill_population)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>city</th>\n",
       "      <th>cuisine_style</th>\n",
       "      <th>ranking</th>\n",
       "      <th>rating</th>\n",
       "      <th>price_range</th>\n",
       "      <th>nor</th>\n",
       "      <th>reviews</th>\n",
       "      <th>url_ta</th>\n",
       "      <th>id_ta</th>\n",
       "      <th>cnt_kitchen</th>\n",
       "      <th>reviews_date</th>\n",
       "      <th>city_population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>id_5569</td>\n",
       "      <td>Paris</td>\n",
       "      <td>['European', 'French', 'International']</td>\n",
       "      <td>5570.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>2</td>\n",
       "      <td>194.0</td>\n",
       "      <td>[['Good food at your doorstep', 'A good hotel ...</td>\n",
       "      <td>/Restaurant_Review-g187147-d1912643-Reviews-R_...</td>\n",
       "      <td>d1912643</td>\n",
       "      <td>3</td>\n",
       "      <td>[12/31/2017, 11/20/2017]</td>\n",
       "      <td>2.148</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>id_1535</td>\n",
       "      <td>Stockholm</td>\n",
       "      <td>[none]</td>\n",
       "      <td>1537.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>[['Unique cuisine', 'Delicious Nepalese food']...</td>\n",
       "      <td>/Restaurant_Review-g189852-d7992032-Reviews-Bu...</td>\n",
       "      <td>d7992032</td>\n",
       "      <td>1</td>\n",
       "      <td>[07/06/2017, 06/19/2016]</td>\n",
       "      <td>0.976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>id_352</td>\n",
       "      <td>London</td>\n",
       "      <td>['Japanese', 'Sushi', 'Asian', 'Grill', 'Veget...</td>\n",
       "      <td>353.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3</td>\n",
       "      <td>688.0</td>\n",
       "      <td>[['Catch up with friends', 'Not exceptional'],...</td>\n",
       "      <td>/Restaurant_Review-g186338-d8632781-Reviews-RO...</td>\n",
       "      <td>d8632781</td>\n",
       "      <td>7</td>\n",
       "      <td>[01/08/2018, 01/06/2018]</td>\n",
       "      <td>8.982</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>id_3456</td>\n",
       "      <td>Berlin</td>\n",
       "      <td>[none]</td>\n",
       "      <td>3458.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>[[], []]</td>\n",
       "      <td>/Restaurant_Review-g187323-d1358776-Reviews-Es...</td>\n",
       "      <td>d1358776</td>\n",
       "      <td>1</td>\n",
       "      <td>no_date</td>\n",
       "      <td>3.769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>id_615</td>\n",
       "      <td>Munich</td>\n",
       "      <td>['German', 'Central European', 'Vegetarian Fri...</td>\n",
       "      <td>621.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2</td>\n",
       "      <td>84.0</td>\n",
       "      <td>[['Best place to try a Bavarian food', 'Nice b...</td>\n",
       "      <td>/Restaurant_Review-g187309-d6864963-Reviews-Au...</td>\n",
       "      <td>d6864963</td>\n",
       "      <td>3</td>\n",
       "      <td>[11/18/2017, 02/19/2017]</td>\n",
       "      <td>1.472</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39995</td>\n",
       "      <td>id_499</td>\n",
       "      <td>Milan</td>\n",
       "      <td>['Italian', 'Vegetarian Friendly', 'Vegan Opti...</td>\n",
       "      <td>500.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2</td>\n",
       "      <td>79.0</td>\n",
       "      <td>[['The real Italian experience!', 'Wonderful f...</td>\n",
       "      <td>/Restaurant_Review-g187849-d2104414-Reviews-Ro...</td>\n",
       "      <td>d2104414</td>\n",
       "      <td>4</td>\n",
       "      <td>[12/16/2017, 11/12/2017]</td>\n",
       "      <td>1.352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39996</td>\n",
       "      <td>id_6340</td>\n",
       "      <td>Paris</td>\n",
       "      <td>['French', 'American', 'Bar', 'European', 'Veg...</td>\n",
       "      <td>6341.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>2</td>\n",
       "      <td>542.0</td>\n",
       "      <td>[['Parisian atmosphere', 'Bit pricey but inter...</td>\n",
       "      <td>/Restaurant_Review-g187147-d1800036-Reviews-La...</td>\n",
       "      <td>d1800036</td>\n",
       "      <td>5</td>\n",
       "      <td>[12/21/2017, 12/12/2017]</td>\n",
       "      <td>2.148</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39997</td>\n",
       "      <td>id_1649</td>\n",
       "      <td>Stockholm</td>\n",
       "      <td>['Japanese', 'Sushi']</td>\n",
       "      <td>1652.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>[['Good by swedish standards', 'A hidden jewel...</td>\n",
       "      <td>/Restaurant_Review-g189852-d947615-Reviews-Sus...</td>\n",
       "      <td>d947615</td>\n",
       "      <td>2</td>\n",
       "      <td>[11/03/2016, 04/12/2008]</td>\n",
       "      <td>0.976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39998</td>\n",
       "      <td>id_640</td>\n",
       "      <td>Warsaw</td>\n",
       "      <td>['Polish', 'European', 'Eastern European', 'Ce...</td>\n",
       "      <td>641.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2</td>\n",
       "      <td>70.0</td>\n",
       "      <td>[['Underground restaurant', 'Oldest Restaurant...</td>\n",
       "      <td>/Restaurant_Review-g274856-d1100838-Reviews-Ho...</td>\n",
       "      <td>d1100838</td>\n",
       "      <td>5</td>\n",
       "      <td>[07/11/2017, 06/18/2017]</td>\n",
       "      <td>1.708</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39999</td>\n",
       "      <td>id_4824</td>\n",
       "      <td>Milan</td>\n",
       "      <td>['Spanish']</td>\n",
       "      <td>4827.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2</td>\n",
       "      <td>260.0</td>\n",
       "      <td>[['Average', 'Nice an informal'], ['01/31/2016...</td>\n",
       "      <td>/Restaurant_Review-g187849-d1109020-Reviews-Ta...</td>\n",
       "      <td>d1109020</td>\n",
       "      <td>1</td>\n",
       "      <td>[01/31/2016, 07/04/2012]</td>\n",
       "      <td>1.352</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40000 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      restaurant_id       city  \\\n",
       "0           id_5569      Paris   \n",
       "1           id_1535  Stockholm   \n",
       "2            id_352     London   \n",
       "3           id_3456     Berlin   \n",
       "4            id_615     Munich   \n",
       "...             ...        ...   \n",
       "39995        id_499      Milan   \n",
       "39996       id_6340      Paris   \n",
       "39997       id_1649  Stockholm   \n",
       "39998        id_640     Warsaw   \n",
       "39999       id_4824      Milan   \n",
       "\n",
       "                                           cuisine_style  ranking  rating  \\\n",
       "0                ['European', 'French', 'International']   5570.0     3.5   \n",
       "1                                                 [none]   1537.0     4.0   \n",
       "2      ['Japanese', 'Sushi', 'Asian', 'Grill', 'Veget...    353.0     4.5   \n",
       "3                                                 [none]   3458.0     5.0   \n",
       "4      ['German', 'Central European', 'Vegetarian Fri...    621.0     4.0   \n",
       "...                                                  ...      ...     ...   \n",
       "39995  ['Italian', 'Vegetarian Friendly', 'Vegan Opti...    500.0     4.5   \n",
       "39996  ['French', 'American', 'Bar', 'European', 'Veg...   6341.0     3.5   \n",
       "39997                              ['Japanese', 'Sushi']   1652.0     4.5   \n",
       "39998  ['Polish', 'European', 'Eastern European', 'Ce...    641.0     4.0   \n",
       "39999                                        ['Spanish']   4827.0     3.0   \n",
       "\n",
       "       price_range    nor                                            reviews  \\\n",
       "0                2  194.0  [['Good food at your doorstep', 'A good hotel ...   \n",
       "1                0   10.0  [['Unique cuisine', 'Delicious Nepalese food']...   \n",
       "2                3  688.0  [['Catch up with friends', 'Not exceptional'],...   \n",
       "3                0    3.0                                           [[], []]   \n",
       "4                2   84.0  [['Best place to try a Bavarian food', 'Nice b...   \n",
       "...            ...    ...                                                ...   \n",
       "39995            2   79.0  [['The real Italian experience!', 'Wonderful f...   \n",
       "39996            2  542.0  [['Parisian atmosphere', 'Bit pricey but inter...   \n",
       "39997            0    4.0  [['Good by swedish standards', 'A hidden jewel...   \n",
       "39998            2   70.0  [['Underground restaurant', 'Oldest Restaurant...   \n",
       "39999            2  260.0  [['Average', 'Nice an informal'], ['01/31/2016...   \n",
       "\n",
       "                                                  url_ta     id_ta  \\\n",
       "0      /Restaurant_Review-g187147-d1912643-Reviews-R_...  d1912643   \n",
       "1      /Restaurant_Review-g189852-d7992032-Reviews-Bu...  d7992032   \n",
       "2      /Restaurant_Review-g186338-d8632781-Reviews-RO...  d8632781   \n",
       "3      /Restaurant_Review-g187323-d1358776-Reviews-Es...  d1358776   \n",
       "4      /Restaurant_Review-g187309-d6864963-Reviews-Au...  d6864963   \n",
       "...                                                  ...       ...   \n",
       "39995  /Restaurant_Review-g187849-d2104414-Reviews-Ro...  d2104414   \n",
       "39996  /Restaurant_Review-g187147-d1800036-Reviews-La...  d1800036   \n",
       "39997  /Restaurant_Review-g189852-d947615-Reviews-Sus...   d947615   \n",
       "39998  /Restaurant_Review-g274856-d1100838-Reviews-Ho...  d1100838   \n",
       "39999  /Restaurant_Review-g187849-d1109020-Reviews-Ta...  d1109020   \n",
       "\n",
       "       cnt_kitchen              reviews_date  city_population  \n",
       "0                3  [12/31/2017, 11/20/2017]            2.148  \n",
       "1                1  [07/06/2017, 06/19/2016]            0.976  \n",
       "2                7  [01/08/2018, 01/06/2018]            8.982  \n",
       "3                1                   no_date            3.769  \n",
       "4                3  [11/18/2017, 02/19/2017]            1.472  \n",
       "...            ...                       ...              ...  \n",
       "39995            4  [12/16/2017, 11/12/2017]            1.352  \n",
       "39996            5  [12/21/2017, 12/12/2017]            2.148  \n",
       "39997            2  [11/03/2016, 04/12/2008]            0.976  \n",
       "39998            5  [07/11/2017, 06/18/2017]            1.708  \n",
       "39999            1  [01/31/2016, 07/04/2012]            1.352  \n",
       "\n",
       "[40000 rows x 13 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ranking</th>\n",
       "      <th>rating</th>\n",
       "      <th>price_range</th>\n",
       "      <th>nor</th>\n",
       "      <th>cnt_kitchen</th>\n",
       "      <th>city_population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>ranking</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.368371</td>\n",
       "      <td>-0.243553</td>\n",
       "      <td>-0.213312</td>\n",
       "      <td>-0.320250</td>\n",
       "      <td>0.545016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>rating</td>\n",
       "      <td>-0.368371</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.051643</td>\n",
       "      <td>0.027969</td>\n",
       "      <td>0.120059</td>\n",
       "      <td>-0.051460</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>price_range</td>\n",
       "      <td>-0.243553</td>\n",
       "      <td>0.051643</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.288053</td>\n",
       "      <td>0.565227</td>\n",
       "      <td>0.015147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>nor</td>\n",
       "      <td>-0.213312</td>\n",
       "      <td>0.027969</td>\n",
       "      <td>0.288053</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.389268</td>\n",
       "      <td>0.015680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>cnt_kitchen</td>\n",
       "      <td>-0.320250</td>\n",
       "      <td>0.120059</td>\n",
       "      <td>0.565227</td>\n",
       "      <td>0.389268</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.018624</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>city_population</td>\n",
       "      <td>0.545016</td>\n",
       "      <td>-0.051460</td>\n",
       "      <td>0.015147</td>\n",
       "      <td>0.015680</td>\n",
       "      <td>0.018624</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  ranking    rating  price_range       nor  cnt_kitchen  \\\n",
       "ranking          1.000000 -0.368371    -0.243553 -0.213312    -0.320250   \n",
       "rating          -0.368371  1.000000     0.051643  0.027969     0.120059   \n",
       "price_range     -0.243553  0.051643     1.000000  0.288053     0.565227   \n",
       "nor             -0.213312  0.027969     0.288053  1.000000     0.389268   \n",
       "cnt_kitchen     -0.320250  0.120059     0.565227  0.389268     1.000000   \n",
       "city_population  0.545016 -0.051460     0.015147  0.015680     0.018624   \n",
       "\n",
       "                 city_population  \n",
       "ranking                 0.545016  \n",
       "rating                 -0.051460  \n",
       "price_range             0.015147  \n",
       "nor                     0.015680  \n",
       "cnt_kitchen             0.018624  \n",
       "city_population         1.000000  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Выводим матрицу корреляций для числовых признаков\n",
    "df.corr()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x175b6190e88>"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Визуализируем корреляции для числовых признаков\n",
    "sns.heatmap(df.corr())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x175b5b4dc48>"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Визуализируем корреляции для числовых признаков\n",
    "sns.heatmap(df.corr(), vmin=0, vmax=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Чем светлее окраска, тем болшее влияние оказывают факторы. Визуализация ярко демнстрирует нам значительное влияние таких признаков как city_population(население города), ranking (место, которое занимает ресторан среди ресторанов города), price_range (диапазон цен),cnt_kitchen(количество кухонь представленных в ресторане)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Х - данные с информацией о ресторанах, у - целевая переменная (рейтинги ресторанов)\n",
    "# применяем для модели 5 числовых признаков, кототрые оказывают влияние на целевую переменную.\n",
    "X = df[['price_range','cnt_kitchen','ranking','nor','city_population']]\n",
    "y = df['rating']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Загружаем специальный инструмент для разбивки:\n",
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Наборы данных с меткой \"train\" будут использоваться для обучения модели, \"test\" - для тестирования.\n",
    "# Для тестирования мы будем использовать 25% от исходного датасета.\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Создаём, обучаем и тестируем модель"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Импортируем необходимые библиотеки:\n",
    "from sklearn.ensemble import RandomForestRegressor # инструмент для создания и обучения модели\n",
    "from sklearn import metrics # инструменты для оценки точности модели"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Создаём модель\n",
    "regr = RandomForestRegressor(n_estimators=100)\n",
    "\n",
    "# Обучаем модель на тестовом наборе данных\n",
    "regr.fit(X_train, y_train)\n",
    "\n",
    "# Используем обученную модель для предсказания рейтинга ресторанов в тестовой выборке.\n",
    "# Предсказанные значения записываем в переменную y_pred\n",
    "y_pred = regr.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MAE: 0.219545\n"
     ]
    }
   ],
   "source": [
    "# Сравниваем предсказанные значения (y_pred) с реальными (y_test), и смотрим насколько они в среднем отличаются\n",
    "# Метрика называется Mean Absolute Error (MAE) и показывает среднее отклонение предсказанных значений от фактических.\n",
    "print('MAE:', metrics.mean_absolute_error(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "MAE 0.22 означает, что среднее отклонение предсказанных моделью значений от фактических составляет 22%"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
